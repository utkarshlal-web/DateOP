<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>OP Dashboard</title>
  <style>
    :root{
      --bg:#fbfbfd; --panel:#ffffff; --card:#ffffff; --ink:#1f2937; --muted:#6b7280;
      --accent:#2563eb; --border: rgba(15, 23, 42, .12);
    }
    *{box-sizing:border-box}
    body{
      margin:0;background:var(--bg);
      color:var(--ink);font:16px/1.55 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
    }
    header{padding:28px 22px 10px}
    h1{margin:0;font-size:28px;font-weight:800}
    header p{margin:6px 0 0;color:var(--muted)}

    .wrap{display:grid;grid-template-columns:320px 1fr;gap:18px;padding:0 22px 28px}
    @media (max-width:900px){.wrap{grid-template-columns:1fr}}

    .panel{background:var(--panel);border:1px solid var(--border);border-radius:16px;padding:14px;position:sticky;top:12px;height:max-content;box-shadow:0 8px 24px rgba(2,8,23,.05)}
    .panel h2{margin:6px 6px 10px;font-size:13px;text-transform:uppercase;color:var(--muted);letter-spacing:.12em}

    .filters{display:grid;gap:10px}
    .field{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:10px}
    .field label{display:block;font-size:12px;color:var(--muted);margin-bottom:6px}
    .field select,.field input[type="text"]{
      width:100%;background:#f8fafc;color:var(--ink);border:1px solid var(--border);border-radius:10px;padding:10px
    }

    .actions{display:flex;gap:8px;flex-wrap:wrap}
    .btn{background:var(--accent);border:none;color:#fff;border-radius:10px;padding:10px 12px;font-weight:700;cursor:pointer}
    .btn.secondary{background:#e5e7eb;color:#111827;border:1px solid var(--border)}

    .list{display:grid;grid-template-columns:repeat(2,minmax(280px,1fr));gap:14px}
    @media (max-width:1100px){.list{grid-template-columns:1fr}}

    .card{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:16px;display:flex;gap:10px;flex-direction:column;box-shadow:0 8px 24px rgba(2,8,23,.05)}
    .card h3{margin:0 0 6px;font-size:18px}
    .k{color:var(--muted)}
    .badges{display:flex;flex-wrap:wrap;gap:6px;margin-bottom:6px}
    .badge{background:#f3f4f6;border:1px solid var(--border);color:#374151;padding:4px 8px;border-radius:999px;font-size:12px}

    .cta{margin-top:6px;display:flex;gap:8px;flex-wrap:wrap}
    a.inline{color:#1d4ed8;text-decoration:none}

    /* Popover */
    .popover{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.35);z-index:10}
    .popover.show{display:flex}
    .sheet{background:var(--panel);border:1px solid var(--border);border-radius:16px;padding:16px;max-width:520px;width:92%}
    .sheet h4{margin:0 0 8px}
    .row{display:flex;gap:10px;align-items:center;margin:8px 0}
    .row input[type="text"]{flex:1;background:#f8fafc;border:1px solid var(--border);border-radius:10px;padding:8px}
  </style>
</head>
<body>
  <header>
    <h1>OP Dashboard</h1>
    <p><em>I figure you're familiar with dashboards, so this should be easy!</em></p>
  </header>

  <div class="wrap">
    <aside class="panel">
      <h2>Filters</h2>
      <div class="filters">
        <div class="field">
          <label for="q">Search</label>
          <input id="q" type="text" placeholder="Search title, venue…" />
        </div>

        <div class="field">
          <label for="loc">Location</label>
          <select id="loc">
            <option value="">Any</option>
            <option value="South">South</option>
            <option value="Central">Central</option>
            <option value="North">North</option>
          </select>
        </div>

        <div class="field">
          <label for="day">Day</label>
          <select id="day">
            <option value="">Any</option>
            <option>Weekday</option>
            <option>Weekend</option>
            <option>Tuesday</option>
            <option>Thursday</option>
            <option>Saturday</option>
          </select>
        </div>

        <div class="field">
          <label for="time">Time of day</label>
          <select id="time">
            <option value="">Any</option>
            <option>Morning</option>
            <option>Afternoon</option>
            <option>Evening</option>
            <option>Night</option>
          </select>
        </div>

        <div class="field">
          <label for="commit">Time commitment</label>
          <select id="commit">
            <option value="">Any</option>
            <option>2–3 hrs</option>
            <option>3–4 hrs</option>
            <option>Half-day</option>
          </select>
        </div>

        <div class="field">
          <label for="type">Type</label>
          <select id="type">
            <option value="">Any</option>
            <option>Culture</option>
            <option>Sport</option>
            <option>Comedy</option>
            <option>Music</option>
            <option>Open Mic</option>
            <option>Game</option>
          </select>
        </div>

        <div class="actions">
          <button class="btn" id="copyLink">Copy filter link</button>
          <button class="btn secondary" id="reset">Reset</button>
        </div>
      </div>
    </aside>

    <main>
      <div id="list" class="list"></div>
    </main>
  </div>

  <!-- Popover -->
  <div id="pop" class="popover">
    <div class="sheet">
      <h4 id="pop-title">Confirm your pick</h4>
      <div class="row"><input type="checkbox" id="withMeal" /><label for="withMeal">With meal</label></div>
      <div class="row"><input id="customPlan" type="text" placeholder="Add a note or your own plan (optional)"/></div>
      <div class="actions">
        <button class="btn" id="copyChoice">Copy link</button>
        <button class="btn secondary" id="waChoice">WhatsApp</button>
        <button class="btn secondary" id="cancelPop">Cancel</button>
      </div>
    </div>
  </div>

<script>
// ---------- Owner contact ----------
const OWNER_PHONE = '919838006777'; // WhatsApp number only

// ---------- Plans (longer, date-friendly durations) ----------
const PLANS = [
  {
    id:'begum',
    title:'Badass Begum: Women & Architecture in Old Delhi',
    subtitle:'Heritage walk',
    type:'Culture',
    url:'https://www.district.in/events/badass-begum-women-architecture-in-old-delhi-aug30-2025-buy-tickets',
    venue:'Old Delhi',location:'Central',
    days:['Saturday','Weekend'],times:['Morning'],
    commitment:'3–4 hrs'
  },
  {
    id:'siri',
    title:'Badminton / Pickleball at Siri Fort',
    subtitle:'Court session',
    type:'Sport',
    url:'#',
    venue:'Siri Fort Sports Complex',location:'South',
    days:['Weekday','Weekend'],times:['Morning','Evening'],
    commitment:'2–3 hrs'
  },
  {
    id:'sloss',
    title:'Daniel Sloss: The New Show',
    subtitle:'Stand-up (BookMyShow)',
    type:'Comedy',
    url:'https://in.bookmyshow.com',
    venue:'South Delhi (see BMS for exact venue)',location:'South',
    days:['Weekday','Weekend'],times:['Evening','Night'],
    commitment:'3–4 hrs'
  },
  {
    id:'karaoke',
    title:'Karaoke @ Garage Delhi',
    subtitle:'Tue / Thu nights',
    type:'Music',
    url:'https://www.instagram.com/garageinc.delhi/?hl=en',
    venue:'Garage Delhi',location:'Central',
    days:['Tuesday','Thursday','Weekday'],times:['Evening','Night'],
    commitment:'3–4 hrs'
  },
  {
    id:'openmic',
    title:'Saturday Open Mic – Comedy • Poetry • Storytelling • Music',
    subtitle:'District.in',
    type:'Open Mic',
    url:'https://www.district.in/events/comedy-poetry-storytelling-music-saturday-open-mic-delhi-nov30-2024-buy-tickets',
    venue:'Delhi',location:'Central',
    days:['Saturday','Weekend'],times:['Evening'],
    commitment:'3–4 hrs'
  },
  {
    id:'escapecp',
    title:'Escape Room – The Hidden Hour (Connaught Place)',
    subtitle:'Solve clues, beat the clock',
    type:'Game',
    url:'https://www.thehiddenhour.com/delhi/connaught-place',
    venue:'Connaught Place',location:'Central',
    days:['Weekday','Weekend'],times:['Afternoon','Evening'],
    commitment:'2–3 hrs'
  },
  {
    id:'escapesouth',
    title:'Escape Room – The Hidden Hour (South Delhi)',
    subtitle:'Pick a theme & crack codes',
    type:'Game',
    url:'https://www.thehiddenhour.com/delhi/connaught-place', /* replace if you have a distinct south link */
    venue:'South Delhi',location:'South',
    days:['Weekday','Weekend'],times:['Afternoon','Evening'],
    commitment:'2–3 hrs'
  }
];

const OWN_ID='ownplan'; const NI_ID='notinterested';
  // ---------- Filters (URL-backed so links are shareable) ----------
const params = new URLSearchParams(location.search);
const state = {
  q: params.get('q') || '',
  loc: params.get('loc') || '',
  day: params.get('day') || '',
  time: params.get('time') || '',
  commit: params.get('commit') || '',
  type: params.get('type') || '',
  plan: params.get('plan') || '',
  meal: params.get('meal') || '',
  own: params.get('own') || ''
};

function setParam(k,v){
  const p = new URLSearchParams(location.search);
  if(v) p.set(k,v); else p.delete(k);
  const url = `${location.pathname}?${p.toString()}`;
  history.replaceState(null,'', url.endsWith('?')?url.slice(0,-1):url);
}

function syncControls(){
  document.getElementById('q').value = state.q;
  document.getElementById('loc').value = state.loc;
  document.getElementById('day').value = state.day;
  document.getElementById('time').value = state.time;
  document.getElementById('commit').value = state.commit;
  document.getElementById('type').value = state.type;
}

['q','loc','day','time','commit','type'].forEach(id=>{
  document.getElementById(id).addEventListener(id==='q'?'input':'change', e=>{
    state[id] = e.target.value;
    setParam(id, state[id]);
    render();
  });
});

// ---------- Helpers ----------
function passFilters(p){
  if(state.q){
    const hay = `${p.title} ${p.subtitle} ${p.venue} ${p.type}`.toLowerCase();
    if(!hay.includes(state.q.toLowerCase())) return false;
  }
  if(state.loc && p.location !== state.loc) return false;
  if(state.day && !(p.days||[]).includes(state.day)) return false;
  if(state.time && !(p.times||[]).includes(state.time)) return false;
  if(state.commit && p.commitment !== state.commit) return false;
  if(state.type && p.type !== state.type) return false;
  return true;
}

// ---------- Rendering ----------
function render(){
  syncControls();
  const list = document.getElementById('list');
  list.innerHTML = '';

  const items = PLANS.filter(passFilters);
  if(items.length === 0){
    const empty = document.createElement('div');
    empty.className = 'card';
    empty.innerHTML = `<h3>No matching plans</h3><p class="k">Try clearing a filter.</p>`;
    list.appendChild(empty);
  } else {
    items.forEach(p=>list.appendChild(planCard(p)));
  }
  list.appendChild(ownPlanCard());
  list.appendChild(notInterestedCard());
}

function planCard(p){
  const c = document.createElement('div');
  c.className = 'card';
  const timeBadge = (p.times||[]).join(' / ') || 'Any time';
  const dayBadge  = (p.days||[]).join(' / ') || 'Any day';
  c.innerHTML = `
    <div class="badges">
      <span class="badge">${p.location}</span>
      <span class="badge">${p.type}</span>
      <span class="badge">${p.commitment}</span>
    </div>
    <h3>${p.title}</h3>
    <div class="k">${p.subtitle}</div>
    <div class="k"><strong>Venue:</strong> ${p.venue}</div>
    <div class="k"><strong>When:</strong> ${dayBadge} • ${timeBadge}</div>
    <div class="cta">
      ${p.url?`<a class="inline" href="${p.url}" target="_blank" rel="noopener">More details</a>`:''}
      <button class="btn" data-confirm="${p.id}">Confirm</button>
    </div>
  `;
  setTimeout(()=>{
    c.querySelector('button[data-confirm]').onclick = ()=> openPick(p.id);
  },0);
  return c;
}

function ownPlanCard(){
  const c = document.createElement('div');
  c.className = 'card';
  c.innerHTML = `
    <div class="badges"><span class="badge">Custom</span></div>
    <h3>Make your own plan</h3>
    <input id="ownPlanInput" type="text" placeholder="e.g., India Gate stroll + coffee at CP"/>
    <div class="cta"><button class="btn" id="ownConfirm">Confirm</button></div>
  `;
  setTimeout(()=>{
    document.getElementById('ownConfirm').onclick = ()=>{
      const txt = (document.getElementById('ownPlanInput').value||'').trim();
      openPick(OWN_ID, txt);
    };
  },0);
  return c;
}

function notInterestedCard(){
  const c = document.createElement('div');
  c.className = 'card';
  c.innerHTML = `
    <div class="badges"><span class="badge">Skip</span></div>
    <h3>Not interested</h3>
    <p class="k">Lovely effort — I'm going to pass this time.</p>
    <div class="cta"><button class="btn secondary" id="niBtn">Send response</button></div>
  `;
  setTimeout(()=>{
    document.getElementById('niBtn').onclick = ()=>{
      openPick(NI_ID, 'Not interested');
    };
  },0);
  return c;
}

// ---------- Share filter link ----------
document.getElementById('copyLink').onclick = ()=>{
  navigator.clipboard.writeText(location.href)
    .then(()=>alert('Filter link copied!'))
    .catch(()=>alert('Could not copy. Please copy from address bar.'));
};

// ---------- Reset ----------
document.getElementById('reset').onclick = ()=>{
  const keys = ['q','loc','day','time','commit','type','plan','meal','own'];
  keys.forEach(k=>setParam(k,''));
  Object.assign(state, {q:'',loc:'',day:'',time:'',commit:'',type:'',plan:'',meal:'',own:''});
  render();
};

// ---------- Popover (Confirm) ----------
const pop = document.getElementById('pop');
const withMeal = document.getElementById('withMeal');
const customPlan = document.getElementById('customPlan');
let selected = '';

function openPick(id,txt=''){
  selected = id;
  const plan = PLANS.find(p=>p.id===id);
  document.getElementById('pop-title').textContent = `Confirm: ${plan?plan.title:(id===OWN_ID? 'Your plan' : 'Selection')}`;
  withMeal.checked = false;
  customPlan.value = (id===OWN_ID)?(txt||''): (id===NI_ID? 'Not interested' : '');
  pop.classList.add('show');
}
document.getElementById('cancelPop').onclick = ()=> pop.classList.remove('show');

function selectionUrl(planId, meal, ownText){
  const p = new URLSearchParams(location.search);
  p.set('plan', planId);
  if(meal) p.set('meal','with'); else p.delete('meal');
  if(ownText) p.set('own', ownText); else p.delete('own');
  return `${location.origin}${location.pathname}?${p.toString()}`;
}

function shareSelection(via){
  const meal = withMeal.checked ? 'with' : '';
  const ownText = (customPlan.value||'').trim();
  // reflect in state/URL
  state.plan = selected; state.meal = meal; state.own = ownText;
  setParam('plan', state.plan); setParam('meal', state.meal); setParam('own', state.own);

  const link = selectionUrl(selected, meal, ownText);
  const plan = PLANS.find(p=>p.id===selected);
  const title = plan ? plan.title : (selected===OWN_ID ? (ownText||'Custom plan') : 'Not interested');
  const msg = `OP Dashboard choice:\n${title}${meal?' (with meal)':''}${ownText?`\nNote: ${ownText}`:''}\n${link}`;

  if(via==='wa'){
    window.open(`https://wa.me/${OWNER_PHONE}?text=${encodeURIComponent(msg)}`,'_blank');
  } else {
    navigator.clipboard.writeText(msg)
      .then(()=>alert('Choice copied!'))
      .catch(()=>alert('Could not copy. Please copy from address bar.'));
  }
  pop.classList.remove('show');
}

document.getElementById('copyChoice').onclick = ()=> shareSelection('copy');
document.getElementById('waChoice').onclick   = ()=> shareSelection('wa');

// ---------- Init ----------
render();
</script>
</body>
</html>
